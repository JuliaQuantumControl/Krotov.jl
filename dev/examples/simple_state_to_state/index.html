<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example 1 (TLS) · Krotov.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://juliaquantumcontrol.github.io/Krotov.jl/examples/simple_state_to_state/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Krotov.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../overview/">Overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">List of Examples</a></li><li class="is-active"><a class="tocitem" href>Example 1 (TLS)</a><ul class="internal"><li><a class="tocitem" href="#Two-level-Hamiltonian"><span>Two-level Hamiltonian</span></a></li><li><a class="tocitem" href="#Optimization-target"><span>Optimization target</span></a></li><li><a class="tocitem" href="#Simulate-dynamics-under-the-guess-field"><span>Simulate dynamics under the guess field</span></a></li><li><a class="tocitem" href="#Optimize"><span>Optimize</span></a></li><li><a class="tocitem" href="#Simulate-the-dynamics-under-the-optimized-field"><span>Simulate the dynamics under the optimized field</span></a></li></ul></li><li><a class="tocitem" href="../state_to_state_rwa/">Example 2 (RWA)</a></li><li><a class="tocitem" href="../rho_3states/">Example 3 (Diss. Gate)</a></li><li><a class="tocitem" href="../state_to_state_parametrizations/">Example 4 (Parametrization)</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Example 1 (TLS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example 1 (TLS)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaQuantumControl/Krotov.jl/blob/master/examples/simple_state_to_state.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System"><a class="docs-heading-anchor" href="#Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System">Example 1: Optimization of a State-to-State Transfer in a Two-Level-System</a><a id="Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This example is also available as a Jupyter notebook: <a href="https://nbviewer.jupyter.org/github/JuliaQuantumControl/Krotov.jl/blob/gh-pages/dev/examples/simple_state_to_state.ipynb"><code>simple_state_to_state.ipynb</code></a>.</p><p>Compare this example against the <a href="https://qucontrol.github.io/krotov/v1.2.1/notebooks/01_example_simple_state_to_state.html">same example using the <code>krotov</code> Python package</a>.</p></div></div><p><span>$\gdef\op#1{\hat{#1}}$</span> <span>$\gdef\init{\text{init}}$</span> <span>$\gdef\tgt{\text{tgt}}$</span></p><p>This first example illustrates the basic use of the <code>Krotov.jl</code> by solving a simple canonical optimization problem: the transfer of population in a two level system.</p><pre><code class="language-julia hljs">using QuantumControl
using LinearAlgebra</code></pre><h2 id="Two-level-Hamiltonian"><a class="docs-heading-anchor" href="#Two-level-Hamiltonian">Two-level Hamiltonian</a><a id="Two-level-Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#Two-level-Hamiltonian" title="Permalink"></a></h2><p>We consider the Hamiltonian <span>$\op{H}_{0} = - \frac{\omega}{2} \op{\sigma}_{z}$</span>, representing a simple qubit with energy level splitting <span>$\omega$</span> in the basis <span>$\{\ket{0},\ket{1}\}$</span>. The control field <span>$\epsilon(t)$</span> is assumed to couple via the Hamiltonian <span>$\op{H}_{1}(t) = \epsilon(t) \op{\sigma}_{x}$</span> to the qubit, i.e., the control field effectively drives transitions between both qubit states.</p><p>We we will use</p><pre><code class="language-julia hljs">ϵ(t) = 0.2 * QuantumControl.shapes.flattop(t, T=5, t_rise=0.3, func=:blackman);</code></pre><pre><code class="language-julia hljs">&quot;&quot;&quot;Two-level-system Hamiltonian.&quot;&quot;&quot;
function hamiltonian(Ω=1.0, ϵ=ϵ)
    σ̂_z = ComplexF64[1 0; 0 -1];
    σ̂_x = ComplexF64[0 1; 1  0];
    Ĥ₀ = -0.5 * Ω * σ̂_z
    Ĥ₁ = σ̂_x
    return (Ĥ₀, (Ĥ₁, ϵ))
end
;</code></pre><pre><code class="language-julia hljs">H = hamiltonian();</code></pre><p>The control field here switches on from zero at <span>$t=0$</span> to it&#39;s maximum amplitude 0.2 within the time period 0.3 (the switch-on shape is half a <a href="https://en.wikipedia.org/wiki/Window_function#Blackman_window">Blackman pulse</a>). It switches off again in the time period 0.3 before the final time <span>$T=5$</span>). We use a time grid with 500 time steps between 0 and <span>$T$</span>:</p><pre><code class="language-julia hljs">tlist = collect(range(0, 5, length=500));</code></pre><pre><code class="language-julia hljs">using PyPlot
matplotlib.use(&quot;Agg&quot;)

function plot_control(pulse::Vector, tlist)
    fig, ax = matplotlib.pyplot.subplots(figsize=(6, 3))
    ax.plot(tlist, pulse)
    ax.set_xlabel(&quot;time&quot;)
    ax.set_ylabel(&quot;amplitude&quot;)
    return fig
end

plot_control(ϵ::T, tlist) where T&lt;:Function =
    plot_control([ϵ(t) for t in tlist], tlist)

plot_control(H[2][2], tlist)</code></pre><img src="data:image/png;base64,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" /><h2 id="Optimization-target"><a class="docs-heading-anchor" href="#Optimization-target">Optimization target</a><a id="Optimization-target-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-target" title="Permalink"></a></h2><p>The <code>krotov</code> package requires the goal of the optimization to be described by a list of <code>Objective</code> instances. In this example, there is only a single objective: the state-to-state transfer from initial state <span>$\ket{\Psi_{\init}} = \ket{0}$</span> to the target state <span>$\ket{\Psi_{\tgt}} = \ket{1}$</span>, under the dynamics of the Hamiltonian <span>$\op{H}(t)$</span>:</p><pre><code class="language-julia hljs">function ket(label)
    result = Dict(
        &quot;0&quot; =&gt; Vector{ComplexF64}([1, 0]),
        &quot;1&quot; =&gt; Vector{ComplexF64}([0, 1]),
    )
    return result[string(label)]
end
;</code></pre><pre><code class="language-julia hljs">objectives = [
    Objective(initial_state=ket(0), generator=H, target_state=ket(1))
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{QuantumControlBase.Objective{Vector{ComplexF64}, Tuple{Matrix{ComplexF64}, Tuple{Matrix{ComplexF64}, typeof(Main.ϵ)}}}}:
 QuantumControlBase.Objective{Vector{ComplexF64}, Tuple{Matrix{ComplexF64}, Tuple{Matrix{ComplexF64}, typeof(Main.ϵ)}}}(ComplexF64[1.0 + 0.0im, 0.0 + 0.0im], (ComplexF64[-0.5 - 0.0im -0.0 - 0.0im; -0.0 - 0.0im 0.5 - 0.0im], (ComplexF64[0.0 + 0.0im 1.0 + 0.0im; 1.0 + 0.0im 0.0 + 0.0im], Main.ϵ)), ComplexF64[0.0 + 0.0im, 1.0 + 0.0im])</code></pre><pre><code class="language-julia hljs">problem = ControlProblem(
    objectives=objectives,
    pulse_options=IdDict(
        ϵ  =&gt; Dict(
            :lambda_a =&gt; 5,
            :update_shape =&gt; t -&gt; QuantumControl.shapes.flattop(
                t, T=5, t_rise=0.3, func=:blackman
            ),
        )
    ),
    tlist=tlist,
    iter_stop=50,
    chi=QuantumControl.functionals.chi_ss!,
    J_T=QuantumControl.functionals.J_T_ss,
    check_convergence= res -&gt; begin (
            (res.J_T &lt; 1e-3)
            &amp;&amp; (res.converged = true)
            &amp;&amp; (res.message=&quot;J_T &lt; 10⁻³&quot;)
        ) end
);</code></pre><h2 id="Simulate-dynamics-under-the-guess-field"><a class="docs-heading-anchor" href="#Simulate-dynamics-under-the-guess-field">Simulate dynamics under the guess field</a><a id="Simulate-dynamics-under-the-guess-field-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-dynamics-under-the-guess-field" title="Permalink"></a></h2><p>Before running the optimization procedure, we first simulate the dynamics under the guess field <span>$\epsilon_{0}(t)$</span>. The following solves equation of motion for the defined objective, which contains the initial state <span>$\ket{\Psi_{\init}}$</span> and the Hamiltonian <span>$\op{H}(t)$</span> defining its evolution.</p><pre><code class="language- hljs">guess_dynamics = propagate_objective(
        objectives[1], problem.tlist;
        storage=true, observables=(Ψ-&gt;abs.(Ψ).^2, )
)</code></pre><pre><code class="language- hljs">function plot_population(pop0::Vector, pop1::Vector, tlist)
    fig, ax = matplotlib.pyplot.subplots(figsize=(6, 3))
    ax.plot(tlist, pop0, label=&quot;0&quot;)
    ax.plot(tlist, pop1, label=&quot;1&quot;)
    ax.legend()
    ax.set_xlabel(&quot;time&quot;)
    ax.set_ylabel(&quot;population&quot;)
    return fig
end

plot_population(guess_dynamics[1,:], guess_dynamics[2,:], tlist)</code></pre><h2 id="Optimize"><a class="docs-heading-anchor" href="#Optimize">Optimize</a><a id="Optimize-1"></a><a class="docs-heading-anchor-permalink" href="#Optimize" title="Permalink"></a></h2><p>In the following we optimize the guess field <span>$\epsilon_{0}(t)$</span> such that the intended state-to-state transfer <span>$\ket{\Psi_{\init}} \rightarrow \ket{\Psi_{\tgt}}$</span> is solved, via the <code>krotov</code> package&#39;s central <code>optimize_pulses</code> routine.  It requires, besides the previously defined <code>objectives</code>, information about the optimization functional <span>$J_T$</span> (implicitly, via <code>chi_constructor</code>, which calculates the states <span>$\ket{\chi} = \frac{J_T}{\bra{\Psi}}$</span>).</p><pre><code class="language-julia hljs">opt_result = optimize(problem, method=:krotov);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> iter.        J_T   ∫gₐ(t)dt          J       ΔJ_T         ΔJ    secs
     0   9.51e-01   0.00e+00   9.51e-01        n/a        n/a     7.3
     1   9.24e-01   1.20e-02   9.36e-01  -2.71e-02  -1.50e-02     0.9
     2   8.83e-01   1.83e-02   9.02e-01  -4.11e-02  -2.28e-02     0.0
     3   8.23e-01   2.71e-02   8.50e-01  -6.06e-02  -3.35e-02     0.0
     4   7.37e-01   3.84e-02   7.76e-01  -8.52e-02  -4.68e-02     0.0
     5   6.26e-01   5.07e-02   6.77e-01  -1.11e-01  -6.05e-02     0.0
     6   4.96e-01   6.04e-02   5.56e-01  -1.31e-01  -7.02e-02     0.0
     7   3.62e-01   6.30e-02   4.25e-01  -1.34e-01  -7.09e-02     0.0
     8   2.44e-01   5.65e-02   3.00e-01  -1.18e-01  -6.15e-02     0.0
     9   1.53e-01   4.39e-02   1.97e-01  -9.03e-02  -4.64e-02     0.0
    10   9.20e-02   3.02e-02   1.22e-01  -6.14e-02  -3.12e-02     0.0
    11   5.35e-02   1.90e-02   7.25e-02  -3.85e-02  -1.94e-02     0.0
    12   3.06e-02   1.14e-02   4.20e-02  -2.29e-02  -1.15e-02     0.0
    13   1.73e-02   6.60e-03   2.39e-02  -1.32e-02  -6.64e-03     0.0
    14   9.78e-03   3.76e-03   1.35e-02  -7.54e-03  -3.78e-03     0.0
    15   5.52e-03   2.13e-03   7.65e-03  -4.26e-03  -2.13e-03     0.0
    16   3.11e-03   1.20e-03   4.31e-03  -2.40e-03  -1.20e-03     0.0
    17   1.76e-03   6.77e-04   2.43e-03  -1.36e-03  -6.78e-04     0.0
    18   9.91e-04   3.82e-04   1.37e-03  -7.64e-04  -3.82e-04     0.0</code></pre><pre><code class="language-julia hljs">opt_result</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Krotov Optimization Result
--------------------------
- Started at 2021-12-27T20:44:27.847
- Number of objectives: 1
- Number of iterations: 18
- Value of functional: 9.91129e-04
- Reason for termination: J_T &lt; 10⁻³
- Ended at 2021-12-27T20:44:36.214 (8 seconds, 367 milliseconds)
</code></pre><p>We can plot the optimized field:</p><pre><code class="language-julia hljs">plot_control(opt_result.optimized_controls[1], tlist)</code></pre><img src="data:image/png;base64,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" /><h2 id="Simulate-the-dynamics-under-the-optimized-field"><a class="docs-heading-anchor" href="#Simulate-the-dynamics-under-the-optimized-field">Simulate the dynamics under the optimized field</a><a id="Simulate-the-dynamics-under-the-optimized-field-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-the-dynamics-under-the-optimized-field" title="Permalink"></a></h2><p>Having obtained the optimized control field, we can simulate the dynamics to verify that the optimized field indeed drives the initial state <span>$\ket{\Psi_{\init}} = \ket{0}$</span> to the desired target state <span>$\ket{\Psi_{\tgt}} = \ket{1}$</span>.</p><pre><code class="language- hljs">opt_dynamics = propagate_objective(
        objectives[1], problem.tlist;
        controls_map=IdDict(ϵ  =&gt; opt_result.optimized_controls[1]),
        storage=true, observables=(Ψ-&gt;abs.(Ψ).^2, )
)</code></pre><pre><code class="language- hljs">plot_population(opt_dynamics[1,:], opt_dynamics[2,:], tlist)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« List of Examples</a><a class="docs-footer-nextpage" href="../state_to_state_rwa/">Example 2 (RWA) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 27 December 2021 20:45">Monday 27 December 2021</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
